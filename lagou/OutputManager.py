#!/usr/bin/env python3
from elasticsearch import Elasticsearch
import json
class OutputManager(object):
    def __init__(self):
        self._es = Elasticsearch(['39.97.240.232'], http_auth=('elastic', 'wuyuexpack'), timeout=9200)
    #添加数据到ES
    def _add_data_to_es(self,jsonData):
        try:
            if jsonData is None:
                return
                # 如果索引不存在，则创建索引
            if self._es.indices.exists(index='es_dt_recruit') is not True:
                self._es.indices.create(index='es_dt_recruit')
            # 将refresh设为true，使得添加的文档可以立即搜索到；
            self._es.index(index="es_dt_recruit",doc_type="ed_recruit",body=jsonData)
        except Exception as e:
            print("error:data is{},error is {}".format(jsonData,str(e)))
    #根据url删除数据
    def _del_data_by_url(self,url):
        self._es.delete_by_query(index="es_dt_recruit",body={"query": {"match": {'url':url}}})
        res = self._es.search(index="es_dt_recruit", doc_type="ed_recruit", body={"query": {"match": {'url': url}}})
        print(res)
    #删除所有数据
    def _del_data_by_all(self):
        res=self._es.delete_by_query(index="es_dt_recruit",body={"query": {"match_all": {}}})
        return res

    #根据URL查询
    def _query_data_by_url(self,url):
        res = self._es.search(index="es_dt_recruit", doc_type="ed_recruit", body={"query": {"match": {'url': url}}})
        print(res)
        return res
    #查询所有文档
    def _query_data_by_all(self):
        res=self._es.search(index="es_dt_recruit", doc_type="ed_recruit", body={"query": {"match_all": {}}})
        return res
if __name__ == '__main__':
    out=OutputManager()
    listinfo=[]
    information = {"uuid": "71f77198-dab1-11e9-be98-505bc2fdaa56", "userId": "\u5218\u52cb", "firmId": "", "online": "", "jobId": "-1", "cityId": "", "hcTotal": "-1", "workType": "", "workEdu": "", "workWage": "", "workYear": "", "audit": "", "viewTotal": "", "sort": "1", "sourceId": "11", "sourceName": "\u62c9\u52fe", "createTime": "2019-09-19 15:17:10", "updateTime": "2019-09-19 15:17:10", "workTypeLabel": "\u5168\u804c", "longitude": "113.923552", "latitude": "22.528499", "cityName": "\u6df1\u5733", "firmName": "\u4ebf\u8fbe\u4fe1\u606f\u6280\u672f\uff08\u6df1\u5733\uff09\u6709\u9650\u516c\u53f8", "firmLogo": "i/image/M00/91/41/Cgp3O1iX5ryAG-T-AAAOmZ4LcU4462.png", "affordTags": [], "demandTags": ["Scala", "C++", "\u540e\u7aef", "MySQL"], "cityAddress": "\u5357\u5c71\u533a", "workEduLabel": "\u672c\u79d1", "": "\u5f00\u53d1|\u6d4b\u8bd5|\u8fd0\u7ef4\u7c7b", "jobName": "python", "workWageLabel": "16k-25k", "workYearLabel": "5-10\u5e74", "jobDescription": "\n\n\n\n\n\u804c\u4f4d\u8bf1\u60d1\uff1a\n\u516d\u9669\u4e00\u91d1\u3001\u5458\u5de5\u4f53\u68c0\u3001\u5458\u5de5\u65c5\u6e38\u3001\u9879\u76ee\u5956\u91d1\n\n\n\u804c\u4f4d\u63cf\u8ff0\uff1a\n\n\u7528\u4eba\u8981\u6c42\uff1a\uff08\u9ad8\u7ea7\uff09\n1\u3001\u672c\u79d1\u53ca\u4ee5\u4e0a\u5b66\u5386 \uff0c\u8ba1\u7b97\u673a\u76f8\u5173\u4e13\u4e1a\uff0c 5\u5e74\u4ee5\u4e0a\u4ee3\u7801\u5f00\u53d1\u7ecf\u9a8c\uff1b\n2\u3001\u7cbe\u901aPython\uff0c \u719f\u6089Shell\u3001Julia\u3001Scala\u3001C/C++\u7b49\u4e00\u79cd\u4ee5\u4e0a\u7684\u5f00\u53d1\u8bed\u8a00\uff0c \u719f\u6089Mysql\u3001Mongodb\u3001Redis\u7b49\u4e3b\u6d41\u6570\u636e\u5e93\uff0c \u6709Hadoop, Spark\u7b49\u7ecf\u9a8c\u66f4\u4f73\uff1b\n3\u3001\u719f\u6089Python \u4e3b\u6d41\u6570\u636e\u5206\u6790\u5de5\u5177\u5305Jupyter Pandas\u3001numpy, simpy\u7b49\u5e93\u8005\u4f18\u5148\uff1b\n4\u3001\u5bf9\u4e8e\u5f02\u6b65\u534f\u7a0b\u6709\u6df1\u5165\u7814\u7a76\uff0c\u6709\u5b9e\u9645\u5e94\u7528\u6848\u4f8b\uff0c\u6709\u5927\u578b\u5206\u5e03\u5f0f\u7cfb\u7edf\u8bbe\u8ba1\u53ca\u5f00\u53d1\u7ecf\u9a8c\u4f18\u5148\n\n\n\n\n\n\n\n\u5de5\u4f5c\u5730\u5740\n\n\u6df1\u5733 -\n                    \u5357\u5c71\u533a -\n                    \u5357\u6cb9\n                                            - \u5f69\u8baf\u5927\u53a6\n                                                            \u67e5\u770b\u5730\u56fe\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\u804c\u4f4d\u53d1\u5e03\u8005:\n\n\n\n\n\u738b\u5b89\u59ae\n\n\n\n\n\n\n\n \u62db\u8058\u4e13\u5458 \n\n\n\n\u804a\u5929\u610f\u613f\n1\u4e2a\u6708\u5185\u804c\u4f4d\u53d1\u5e03\u8005\u56de\u590d\u804a\u5929\u7684\u5360\u6bd4\n\n\u4e00\u822c\n\n                            \u56de\u590d\u738753%\u00a0 \u7528\u65f61\u5206\u949f                        \n\n\n\n\u7b80\u5386\u5904\u7406\n7\u65e5\u5185\u804c\u4f4d\u53d1\u5e03\u8005\u7b80\u5386\u5904\u7406\u7684\u6548\u7387\n\u6682\u65e0\n\n                            \u5904\u7406\u7387--\u00a0 \u7528\u65f6--\u5929                        \n\n\n\n\u6d3b\u8dc3\u65f6\u6bb5\n1\u4e2a\u6708\u5185\u804c\u4f4d\u53d1\u5e03\u8005\u6700\u6d3b\u8dc3\u65f6\u6bb5\u7edf\u8ba1\n\u4e0b\u5348\n\n                            \u4e0b\u53482\u70b9\u6700\u6d3b\u8dc3                        \n\n\n\n\n\n\n\n\n      \u9762\u8bd5\u8bc4\u4ef7\n    \n\u67e5\u770b\u8be5\u516c\u53f8\u5168\u90e8\u9762\u8bd5\u8bc4\u4ef7\n\n\n\n\n\n\u770b\u4e86\u6b64\u804c\u4f4d\u7684\u4eba\u8fd8\u4f1a\u770b\n\u67e5\u770b\u66f4\u591a\n\n\n\n\n\n\n\u5c55\u5f00\n\n\u63a8\u8350\u516c\u53f8\uff1a\n\n\u5e7f\u5dde\u7acb\u767d\u4f01\u4e1a\u96c6\u56e2\u6709\u9650\u516c\u53f8\n\u534e\u80fd\u6210\u957f\u5b9d\n\u773a\u773a\u4e91\u6559\u80b2\n\u9e3f\u8054\u4e5d\u4e94\u4fe1\u606f\u4ea7\u4e1a\n\u9876\u5471\u5471\n\u5357\u6816\u4ed9\u7b56\n\u5b87\u4fe1\u6613\u8bda\nGreatSeed\n\u5522\u7eb3\u7f51\u7edc\u79d1\u6280\n\u745e\u9686\u666e\u60e0\n\u6377\u901a\u534e\u58f0\n\u667a\u878d\u96c6\u56e2\n\u5317\u4eac\u9886\u521b\u667a\u4fe1\u79d1\u6280\u6709\u9650\u516c\u53f8\n\u6df1\u5733\u5e02\u524d\u6d77\u8f66\u5178\u79d1\u6280\u6709\u9650\u516c\u53f8\n\u4e50\u5237\n\u6709\u8d5e\n\u6210\u90fd\u601d\u745e\u7279\n\u767d\u9ca8\u6587\u5316\nParticle\n\u5904\u7406\u7f51\n\u6e38\u8702\u79d1\u6280\n\u5b89\u4fe1\u5929\u884c\n\u4e2d\u56fd\u56fd\u65c5\n\u5408\u4f17\u7f8e\u534e\n\u4e2d\u4ea4\u5174\u8def\n\u6c34\u4e4b\u56fd\u73af\u4fdd\n\u534e\u590f\u521b\u65b0\n\u7389\u9f0e\u5723\u623f\u5730\u4ea7\u5f00\u53d1\nETU\n\u4ebf\u6c83\u901a\u79d1\u6280\n\n\n\n\u63a8\u8350\u57ce\u5e02\uff1a\n\n\u5317\u4eac\u627e\u5de5\u4f5c\n\u676d\u5dde\u627e\u5de5\u4f5c\n\u6df1\u5733\u62db\u8058\n\u6b66\u6c49\u62db\u8058\n\u5e7f\u5dde\u627e\u5de5\u4f5c\n\u4e0a\u6d77\u627e\u5de5\u4f5c\n\u6210\u90fd\u627e\u5de5\u4f5c\n\u6c5f\u82cf\u627e\u5de5\u4f5c\n\u6df1\u5733\u627e\u5de5\u4f5c\n\u5317\u4eac\u62db\u8058\n\u6210\u90fd\u62db\u8058\n\u4e0a\u6d77\u62db\u8058\n\u6b66\u6c49\u627e\u5de5\u4f5c\n\u676d\u5dde\u62db\u8058\n\u6c5f\u82cf\u62db\u8058\n\u5e7f\u5dde\u62db\u8058\n\n\n\n\u70ed\u95e8\u804c\u4f4d\uff1a\n\n\u786c\u4ef6\u5f00\u53d1\u5176\u5b83\u62db\u8058\n\u9879\u76ee\u7ecf\u7406\u62db\u8058\nFLASH\u62db\u8058\nPCB\u5de5\u827a\u62db\u8058\nMySQL\u62db\u8058\n\u4ea7\u54c1\u5b9e\u4e60\u751f\u62db\u8058\nPython\u62db\u8058\n\u8d22\u52a1\u603b\u76d1/\u7ecf\u7406\u62db\u8058\n\u56fe\u50cf\u8bc6\u522b\u62db\u8058\n\u7cbe\u51c6\u63a8\u8350\u62db\u8058\n\u4ea4\u4e92\u8bbe\u8ba1\u5e08\u62db\u8058\n\u4ea4\u4e92\u8bbe\u8ba1\u5e08\u62db\u8058\n\u7b56\u5212\u7ecf\u7406\u62db\u8058\n\u8fd0\u7ef4\u603b\u76d1\u62db\u8058\n\u7f51\u7edc\u5b89\u5168\u62db\u8058\n\u7cbe\u76ca\u5de5\u7a0b\u5e08\u62db\u8058\n\u7528\u6237\u8fd0\u8425\u627e\u5de5\u4f5c\n\u8fd0\u8425\u7ecf\u7406\u627e\u5de5\u4f5c\n\u7535\u8bdd\u9500\u552e\u627e\u5de5\u4f5c\n\u5176\u4ed6\u9500\u552e\u7ba1\u7406\u804c\u4f4d\u627e\u5de5\u4f5c\n\u6027\u80fd\u6d4b\u8bd5\u627e\u5de5\u4f5c\n\u6027\u80fd\u6d4b\u8bd5\u627e\u5de5\u4f5c\n\u5e7f\u544a\u534f\u8c03\u627e\u5de5\u4f5c\n\u7528\u6237\u7814\u7a76\u7ecf\u7406/\u4e3b\u7ba1\u627e\u5de5\u4f5c\n\u7cbe\u76ca\u5de5\u7a0b\u5e08\u627e\u5de5\u4f5c\n\u7535\u8bdd\u9500\u552e\u627e\u5de5\u4f5c\nJavaScript\u627e\u5de5\u4f5c\n\u5355\u7247\u673a\u627e\u5de5\u4f5c\n\u8bbe\u8ba1\u603b\u76d1\u627e\u5de5\u4f5c\n\u6d77\u5916\u8fd0\u8425\u627e\u5de5\u4f5c\n\n\n\n\n", "jobDuty": "\n\n\n\n\n\u804c\u4f4d\u8bf1\u60d1\uff1a\n\u516d\u9669\u4e00\u91d1\u3001\u5458\u5de5\u4f53\u68c0\u3001\u5458\u5de5\u65c5\u6e38\u3001\u9879\u76ee\u5956\u91d1\n\n\n\u804c\u4f4d\u63cf\u8ff0\uff1a\n\n\u7528\u4eba\u8981\u6c42\uff1a\uff08\u9ad8\u7ea7\uff09\n1\u3001\u672c\u79d1\u53ca\u4ee5\u4e0a\u5b66\u5386 \uff0c\u8ba1\u7b97\u673a\u76f8\u5173\u4e13\u4e1a\uff0c 5\u5e74\u4ee5\u4e0a\u4ee3\u7801\u5f00\u53d1\u7ecf\u9a8c\uff1b\n2\u3001\u7cbe\u901aPython\uff0c \u719f\u6089Shell\u3001Julia\u3001Scala\u3001C/C++\u7b49\u4e00\u79cd\u4ee5\u4e0a\u7684\u5f00\u53d1\u8bed\u8a00\uff0c \u719f\u6089Mysql\u3001Mongodb\u3001Redis\u7b49\u4e3b\u6d41\u6570\u636e\u5e93\uff0c \u6709Hadoop, Spark\u7b49\u7ecf\u9a8c\u66f4\u4f73\uff1b\n3\u3001\u719f\u6089Python \u4e3b\u6d41\u6570\u636e\u5206\u6790\u5de5\u5177\u5305Jupyter Pandas\u3001numpy, simpy\u7b49\u5e93\u8005\u4f18\u5148\uff1b\n4\u3001\u5bf9\u4e8e\u5f02\u6b65\u534f\u7a0b\u6709\u6df1\u5165\u7814\u7a76\uff0c\u6709\u5b9e\u9645\u5e94\u7528\u6848\u4f8b\uff0c\u6709\u5927\u578b\u5206\u5e03\u5f0f\u7cfb\u7edf\u8bbe\u8ba1\u53ca\u5f00\u53d1\u7ecf\u9a8c\u4f18\u5148\n\n\n\n\n\n\n\n\u5de5\u4f5c\u5730\u5740\n\n\u6df1\u5733 -\n                    \u5357\u5c71\u533a -\n                    \u5357\u6cb9\n                                            - \u5f69\u8baf\u5927\u53a6\n                                                            \u67e5\u770b\u5730\u56fe\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\u804c\u4f4d\u53d1\u5e03\u8005:\n\n\n\n\n\u738b\u5b89\u59ae\n\n\n\n\n\n\n\n \u62db\u8058\u4e13\u5458 \n\n\n\n\u804a\u5929\u610f\u613f\n1\u4e2a\u6708\u5185\u804c\u4f4d\u53d1\u5e03\u8005\u56de\u590d\u804a\u5929\u7684\u5360\u6bd4\n\n\u4e00\u822c\n\n                            \u56de\u590d\u738753%\u00a0 \u7528\u65f61\u5206\u949f                        \n\n\n\n\u7b80\u5386\u5904\u7406\n7\u65e5\u5185\u804c\u4f4d\u53d1\u5e03\u8005\u7b80\u5386\u5904\u7406\u7684\u6548\u7387\n\u6682\u65e0\n\n                            \u5904\u7406\u7387--\u00a0 \u7528\u65f6--\u5929                        \n\n\n\n\u6d3b\u8dc3\u65f6\u6bb5\n1\u4e2a\u6708\u5185\u804c\u4f4d\u53d1\u5e03\u8005\u6700\u6d3b\u8dc3\u65f6\u6bb5\u7edf\u8ba1\n\u4e0b\u5348\n\n                            \u4e0b\u53482\u70b9\u6700\u6d3b\u8dc3                        \n\n\n\n\n\n\n\n\n      \u9762\u8bd5\u8bc4\u4ef7\n    \n\u67e5\u770b\u8be5\u516c\u53f8\u5168\u90e8\u9762\u8bd5\u8bc4\u4ef7\n\n\n\n\n\n\u770b\u4e86\u6b64\u804c\u4f4d\u7684\u4eba\u8fd8\u4f1a\u770b\n\u67e5\u770b\u66f4\u591a\n\n\n\n\n\n\n\u5c55\u5f00\n\n\u63a8\u8350\u516c\u53f8\uff1a\n\n\u5e7f\u5dde\u7acb\u767d\u4f01\u4e1a\u96c6\u56e2\u6709\u9650\u516c\u53f8\n\u534e\u80fd\u6210\u957f\u5b9d\n\u773a\u773a\u4e91\u6559\u80b2\n\u9e3f\u8054\u4e5d\u4e94\u4fe1\u606f\u4ea7\u4e1a\n\u9876\u5471\u5471\n\u5357\u6816\u4ed9\u7b56\n\u5b87\u4fe1\u6613\u8bda\nGreatSeed\n\u5522\u7eb3\u7f51\u7edc\u79d1\u6280\n\u745e\u9686\u666e\u60e0\n\u6377\u901a\u534e\u58f0\n\u667a\u878d\u96c6\u56e2\n\u5317\u4eac\u9886\u521b\u667a\u4fe1\u79d1\u6280\u6709\u9650\u516c\u53f8\n\u6df1\u5733\u5e02\u524d\u6d77\u8f66\u5178\u79d1\u6280\u6709\u9650\u516c\u53f8\n\u4e50\u5237\n\u6709\u8d5e\n\u6210\u90fd\u601d\u745e\u7279\n\u767d\u9ca8\u6587\u5316\nParticle\n\u5904\u7406\u7f51\n\u6e38\u8702\u79d1\u6280\n\u5b89\u4fe1\u5929\u884c\n\u4e2d\u56fd\u56fd\u65c5\n\u5408\u4f17\u7f8e\u534e\n\u4e2d\u4ea4\u5174\u8def\n\u6c34\u4e4b\u56fd\u73af\u4fdd\n\u534e\u590f\u521b\u65b0\n\u7389\u9f0e\u5723\u623f\u5730\u4ea7\u5f00\u53d1\nETU\n\u4ebf\u6c83\u901a\u79d1\u6280\n\n\n\n\u63a8\u8350\u57ce\u5e02\uff1a\n\n\u5317\u4eac\u627e\u5de5\u4f5c\n\u676d\u5dde\u627e\u5de5\u4f5c\n\u6df1\u5733\u62db\u8058\n\u6b66\u6c49\u62db\u8058\n\u5e7f\u5dde\u627e\u5de5\u4f5c\n\u4e0a\u6d77\u627e\u5de5\u4f5c\n\u6210\u90fd\u627e\u5de5\u4f5c\n\u6c5f\u82cf\u627e\u5de5\u4f5c\n\u6df1\u5733\u627e\u5de5\u4f5c\n\u5317\u4eac\u62db\u8058\n\u6210\u90fd\u62db\u8058\n\u4e0a\u6d77\u62db\u8058\n\u6b66\u6c49\u627e\u5de5\u4f5c\n\u676d\u5dde\u62db\u8058\n\u6c5f\u82cf\u62db\u8058\n\u5e7f\u5dde\u62db\u8058\n\n\n\n\u70ed\u95e8\u804c\u4f4d\uff1a\n\n\u786c\u4ef6\u5f00\u53d1\u5176\u5b83\u62db\u8058\n\u9879\u76ee\u7ecf\u7406\u62db\u8058\nFLASH\u62db\u8058\nPCB\u5de5\u827a\u62db\u8058\nMySQL\u62db\u8058\n\u4ea7\u54c1\u5b9e\u4e60\u751f\u62db\u8058\nPython\u62db\u8058\n\u8d22\u52a1\u603b\u76d1/\u7ecf\u7406\u62db\u8058\n\u56fe\u50cf\u8bc6\u522b\u62db\u8058\n\u7cbe\u51c6\u63a8\u8350\u62db\u8058\n\u4ea4\u4e92\u8bbe\u8ba1\u5e08\u62db\u8058\n\u4ea4\u4e92\u8bbe\u8ba1\u5e08\u62db\u8058\n\u7b56\u5212\u7ecf\u7406\u62db\u8058\n\u8fd0\u7ef4\u603b\u76d1\u62db\u8058\n\u7f51\u7edc\u5b89\u5168\u62db\u8058\n\u7cbe\u76ca\u5de5\u7a0b\u5e08\u62db\u8058\n\u7528\u6237\u8fd0\u8425\u627e\u5de5\u4f5c\n\u8fd0\u8425\u7ecf\u7406\u627e\u5de5\u4f5c\n\u7535\u8bdd\u9500\u552e\u627e\u5de5\u4f5c\n\u5176\u4ed6\u9500\u552e\u7ba1\u7406\u804c\u4f4d\u627e\u5de5\u4f5c\n\u6027\u80fd\u6d4b\u8bd5\u627e\u5de5\u4f5c\n\u6027\u80fd\u6d4b\u8bd5\u627e\u5de5\u4f5c\n\u5e7f\u544a\u534f\u8c03\u627e\u5de5\u4f5c\n\u7528\u6237\u7814\u7a76\u7ecf\u7406/\u4e3b\u7ba1\u627e\u5de5\u4f5c\n\u7cbe\u76ca\u5de5\u7a0b\u5e08\u627e\u5de5\u4f5c\n\u7535\u8bdd\u9500\u552e\u627e\u5de5\u4f5c\nJavaScript\u627e\u5de5\u4f5c\n\u5355\u7247\u673a\u627e\u5de5\u4f5c\n\u8bbe\u8ba1\u603b\u76d1\u627e\u5de5\u4f5c\n\u6d77\u5916\u8fd0\u8425\u627e\u5de5\u4f5c\n\n\n\n\n"}
    listinfo.append(information)
    for json in listinfo:
        res=out._add_data_to_es(json)
        # print(res)

